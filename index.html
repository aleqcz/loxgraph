<!doctype html>
<html>
  <head>
    <title>Loxgraph</title>
    <link rel=stylesheet href=bootstrap.min.css>
    <style type=text/css>
      #menu-container {
        border: 2px solid gray;
        margin: 10px;
      }

      #menu-container .selected {
        font-weight: bold;
      }

      #menu-container .date {
        cursor: pointer;
      }

      #graph-container {
        text-align: center;
        vertical-align: middle;
      }

      .dygraph-wrapper {
        position: relative;
      }

      .dygraph-wrapper .close-graph {
        cursor: pointer;
        position: absolute;
        right: 20px;
        top: 20px;
      }

      .dygraph {
        margin: 20px;
        min-height: 320px;
        position: relative;
      }

      .dygraph .loading {
        color: #ddd;
        font-size: 300%;
        position: relative;
        top: 120px;
      }
    </style>
    <script src=jquery-2.1.0.min.js></script>
    <script src=coffee-script.js></script>
    <script src=ractive.min.js></script>
    <script src=dygraph.js></script>
    <script src=script.coffee type=text/coffeescript></script>
  </head>
  <body id=output>
  loading
  </body>
  <script id='template' type='text/ractive'>
    {{#stats}}
      <div id=menu-container>
      <h1>Loxone Graphs</h1>
      <ul>
        {{#stats:id}}
          <li>
            {{title}} ({{categoryAndRoom}})
            <ul>
              {{#urls}}
                <li>
                <a class="date {{selected ? 'selected' : ''}}"
                   on-click=select:{{.}},{{title}}>
                   {{year}}-{{month}}
                </a>
                </li>
              {{/urls}}
            </ul>
          </li>
        {{/stats}}
      </ul>
      </div>
      <div id=graph-container>
        {{#stats:id}}
          {{#urls}}
            {{#selected}}
              <div class=dygraph-wrapper>
                <a on-click=select title=close class=close-graph>
                  x
                </a>
                <div id={{divId}} class=dygraph>
                  <span class=loading>
                    loading
                  </span>
                </div>
            </div>
            {{/selected}}
          {{/urls}}
        {{/stats}}
      </div>
    {{/stats}}
  </script>
</html>
